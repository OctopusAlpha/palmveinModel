# 掌静脉识别系统

## 项目概述

本项目是一个基于深度学习的掌静脉识别系统，利用ResNet18网络提取掌静脉图像特征，实现个体身份识别。系统包含掌静脉ROI区域提取、图像增强、特征提取与匹配等核心功能模块，可用于生物特征识别和身份验证场景。

## 系统架构

系统主要由以下几个部分组成：

1. **数据预处理模块**：包括ROI区域提取和图像增强
2. **特征提取模块**：基于改进的ResNet18网络
3. **特征匹配模块**：使用余弦相似度进行特征匹配
4. **训练与评估模块**：基于Triplet Loss的网络训练和性能评估

### 系统流程

```
输入图像 → ROI提取 → 图像增强 → 特征提取 → 特征匹配 → 身份识别结果
```

## 主要功能模块

### 1. ROI提取模块

掌静脉ROI（感兴趣区域）提取是识别系统的关键前处理步骤，通过以下步骤实现：

- 图像预处理：中值滤波去噪
- 二值化处理：固定阈值二值化
- 距离变换：计算二值图像中每个前景点到最近背景点的距离
- 掌心中心点定位：基于距离变换结果找到掌心中心
- ROI区域提取：以掌心中心为基准提取固定大小的区域

### 2. 图像增强模块

使用CLAHE（对比度受限的自适应直方图均衡化）算法增强掌静脉图像的对比度：

- 中值滤波降噪
- CLAHE对比度增强（clipLimit=4.0, tileGridSize=(5,5)）

### 3. 特征提取模块

基于改进的ResNet18网络进行特征提取：

- 使用预训练的ResNet18作为基础网络
- 添加Dropout和Batch Normalization提高泛化能力
- 改进全连接层结构，输出128维特征向量
- 使用L2归一化处理特征向量

### 4. 特征匹配模块

使用余弦相似度计算特征向量之间的相似度，实现身份匹配：

- 计算查询图像与注册图像的特征向量余弦相似度
- 设定阈值判断是否为同一身份

## 安装步骤

### 环境要求

- Python 3.6+
- CUDA支持（推荐，用于GPU加速）

### 依赖安装

```bash
# 克隆项目
git clone [项目仓库URL]
cd palmveinResNet18

# 安装依赖
pip install -r requirements.txt
```

主要依赖项：
- torch>=1.7.0
- torchvision>=0.8.0
- numpy>=1.19.0
- Pillow>=8.0.0
- matplotlib>=3.3.0
- opencv-python>=4.4.0
- scipy>=1.5.0
- tqdm>=4.50.0

## 使用说明

### 数据准备

1. 将掌静脉图像数据集放置在`dataset`目录下
2. 数据集结构应为：
   ```
   dataset/
     ├── train/
     │   ├── 001/  # 类别1（用户ID）
     │   │   ├── image1.tiff
     │   │   ├── image2.tiff
     │   │   └── ...
     │   ├── 002/  # 类别2
     │   └── ...
     └── valid/
         ├── 001/
         └── ...
   ```

### 模型训练

```bash
python train.py
```

训练参数可在`config.py`中配置，包括：
- 批次大小
- 学习率
- 训练轮数
- 特征维度

### 模型测试

```bash
python test.py
```

### ROI提取测试

```bash
python roi_extraction.py
```

### 图像增强测试

```bash
python CLAHE.py
```

## 性能评估

系统在掌静脉数据集上的性能评估结果：

- 识别准确率：[待填充]
- 等错误率(EER)：[待填充]
- 特征提取时间：[待填充]

## 项目结构

```
├── CLAHE.py                # 图像增强模块
├── batch_roi_extraction.py # 批量ROI提取
├── config.py               # 配置文件
├── model.py                # 模型定义
├── prepare_data.py         # 数据准备
├── requirements.txt        # 项目依赖
├── roi_extraction.py       # ROI提取模块
├── test.py                 # 测试脚本
└── train.py                # 训练脚本
```

## 注意事项

- 图像应为掌静脉图像，建议使用近红外成像设备获取
- 训练数据量建议每个类别不少于5张图像
- GPU训练可大幅提升训练速度

## 许可证

[待填充]

## 联系方式

[待填充]